[
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Hello blog!",
    "section": "",
    "text": "Hello, blog!\nThis is just the first post of the basics blog, exploiting Quarto. Could it be the answer to the need for a simple tool, providing similar experience to Jupyter Books with minimal fancy tools for blogging, like tags, automatic layout of the main page (e.g. with latest post), built with .md and .ipynb, to be publicly hosted on GitHub, and allowing comments with the smallest amount of pain as possible? I’ll find out.\nI’ve come across Quarto just this morning, through some nice examples Mark Isken, Bits of Abalytics, who looks like having some experience with blogging and moved to Quarto after using several other platforms: his blog looks good and clean, it looks like he has my same needs, he looks quite satisfied with Quarto and he’s explaining why in details in his post Firts impressions of blogging with Quarto, written in 2023. There are no later posts about porting, while the last post came out only few days ago: it looks like the blog is alive and he keeps using Quarto. So, why shouldn’t I trust him?"
  },
  {
    "objectID": "posts/welcome-ipynb/index.html",
    "href": "posts/welcome-ipynb/index.html",
    "title": "Hello .ipynb on the blog!",
    "section": "",
    "text": "Just the first try of a notebook post.\n\n#&gt; Import libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n\nx = np.linspace(-np.pi, np.pi, 101)\ny = np.sin(x)\n\n\nplt.figure()\nplt.plot(x,y)\nplt.grid()"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "myblog",
    "section": "",
    "text": "A bit of this and that\n\nLatest posts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNatural modes in structures\n\n\n\nstructural mechanics\n\nnatural modes\n\nresonance\n\n\n\n\n\n\n\n\n\nNov 25, 2025\n\n\nBasics\n\n\n\n\n\n\n\n\n\n\n\n\nWeak formulation of problems in structural mechanics\n\n\n\nstructural mechanics\n\nweak form\n\n\n\n\n\n\n\n\n\nNov 24, 2025\n\n\nBasics\n\n\n\n\n\n\n\n\n\n\n\n\nHello .ipynb on the blog!\n\n\n\nblog\n\njupyter\n\n\n\n\n\n\n\n\n\nNov 24, 2025\n\n\nBasics\n\n\n\n\n\n\n\n\n\n\n\n\nHello blog!\n\n\n\nblog\n\n\n\n\n\n\n\n\n\nNov 24, 2025\n\n\nBasics\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Just a blog about this and that, by Basics."
  },
  {
    "objectID": "posts/hyperstatics-and-weak-form/index.html",
    "href": "posts/hyperstatics-and-weak-form/index.html",
    "title": "Weak formulation of problems in structural mechanics",
    "section": "",
    "text": "This post grew out of a question about a structural mechanics exercise that appeared in a community of structural engineers. The exercise dealt with a hyperstatic beam system with elastic supports and thermal strains.\nIt’s a nice excuse to talk about the role of the weak form — especially compatibility and equilibrium conditions — and to show that the so-called energy theorems follow directly from choosing suitable test functions in the weak formulation."
  },
  {
    "objectID": "posts/hyperstatics-and-weak-form/index.html#linear-elastic-problem",
    "href": "posts/hyperstatics-and-weak-form/index.html#linear-elastic-problem",
    "title": "Weak formulation of problems in structural mechanics",
    "section": "Linear elastic problem",
    "text": "Linear elastic problem\n\\[\\begin{cases}\n  \\boldsymbol\\nabla \\cdot \\boldsymbol\\sigma + \\overline{\\mathbf{f}} = \\mathbf{0}  && \\text{in $V$} \\\\\n  \\boldsymbol\\varepsilon = \\frac{1}{2} \\left( \\boldsymbol\\nabla \\mathbf{s} + \\boldsymbol\\nabla^T \\mathbf{s} \\right) \\\\\n  \\boldsymbol\\sigma = \\mathbf{C} : \\boldsymbol\\varepsilon - \\boldsymbol\\beta \\Delta T \\\\\n  \\mathbf{s} = \\overline{\\mathbf{s}}   && \\text{on $S_D$} \\\\\n  \\hat{\\mathbf{n}} \\cdot \\boldsymbol\\sigma = \\overline{\\mathbf{t}}_n   && \\text{on $S_N$} \\\\\n  \\mathbf{K} \\cdot \\mathbf{s} + \\mathbf{S} \\cdot (\\hat{\\mathbf{n}} \\cdot \\boldsymbol\\sigma ) = \\overline{h}   && \\text{on $S_R$} \\\\\n\\end{cases}\\]"
  },
  {
    "objectID": "posts/hyperstatics-and-weak-form/index.html#equilibrium-conditions",
    "href": "posts/hyperstatics-and-weak-form/index.html#equilibrium-conditions",
    "title": "Weak formulation of problems in structural mechanics",
    "section": "Equilibrium conditions",
    "text": "Equilibrium conditions\n\nStrong form\n\\[\\begin{cases}\n  \\boldsymbol\\nabla \\cdot \\boldsymbol\\sigma + \\overline{\\mathbf{f}} = \\mathbf{0}  && \\text{in $V$} \\\\\n  \\hat{\\mathbf{n}} \\cdot \\boldsymbol\\sigma = \\overline{\\mathbf{t}}_n   && \\text{on $S_N$} \\\\\n\\end{cases}\\]\nwith \\(\\boldsymbol\\sigma = \\mathbf{C} : \\boldsymbol\\varepsilon - \\boldsymbol\\beta \\Delta T\\).\n\n\nWeak form\nFor every sufficiently regular test function \\(\\mathbf{w}\\),\n\\[\\begin{aligned}\n  0\n  & = \\int_{V} \\mathbf{w} \\cdot \\left\\{ \\boldsymbol\\nabla \\cdot \\boldsymbol\\sigma + \\overline{\\mathbf{f}} \\right\\} = \\\\\n  & = \\oint_{\\partial V} \\hat{\\mathbf{n}} \\cdot \\boldsymbol\\sigma \\cdot \\mathbf{w} - \\int_{V} \\boldsymbol\\nabla \\mathbf{w} : \\boldsymbol\\sigma + \\int_{V} \\mathbf{w} \\cdot \\mathbf{f} = \\\\\n  & = \\oint_{\\partial V} \\hat{\\mathbf{n}} \\cdot \\boldsymbol\\sigma \\cdot \\mathbf{w} - \\int_{V} \\dfrac{1}{2} \\left( \\boldsymbol\\nabla \\mathbf{w} + \\boldsymbol\\nabla^T \\mathbf{w} \\right) : \\boldsymbol\\sigma + \\int_{V} \\mathbf{w} \\cdot \\mathbf{f} \\ .\n\\end{aligned}\\]\nhaving exploited the symmetry of the stress tensor \\(\\boldsymbol\\sigma\\).\n\n\n…\n\n\nPVW"
  },
  {
    "objectID": "posts/hyperstatics-and-weak-form/index.html#compatibility-conditions",
    "href": "posts/hyperstatics-and-weak-form/index.html#compatibility-conditions",
    "title": "Weak formulation of problems in structural mechanics",
    "section": "Compatibility conditions",
    "text": "Compatibility conditions\n\nStrong form\n\\[\\begin{cases}\n  \\boldsymbol\\varepsilon = \\frac{1}{2} \\left( \\boldsymbol\\nabla \\mathbf{s} + \\boldsymbol\\nabla^T \\mathbf{s} \\right) && \\text{in $V$} \\\\\n  \\mathbf{s} = \\overline{\\mathbf{s}}   && \\text{on $S_D$} \\\\\n\\end{cases}\\]\nwith \\(\\boldsymbol\\varepsilon = \\mathbf{D} : \\boldsymbol\\sigma + \\boldsymbol\\alpha \\Delta T\\).\n\n\nWeak form\nFor every sufficiently regular test function \\(\\boldsymbol\\Sigma\\) (\\(2^{nd}\\)-order tensor)\n\\[\\begin{aligned}\n  0\n  & = \\int_{V} \\boldsymbol\\Sigma : \\left( \\boldsymbol\\varepsilon - \\dfrac{1}{2} \\left( \\boldsymbol\\nabla \\mathbf{s} + \\boldsymbol\\nabla^T \\mathbf{s} \\right) \\right) = \\\\\n  & = \\int_{V} \\boldsymbol\\Sigma : \\boldsymbol\\varepsilon - \\oint_{\\partial V} \\hat{\\mathbf{n}} \\cdot \\boldsymbol\\Sigma \\cdot \\mathbf{s} + \\int_V \\boldsymbol\\nabla \\cdot \\boldsymbol\\Sigma \\cdot \\mathbf{s} = \\\\\n\\end{aligned}\\]\nif the tensor test function is symmetric \\(\\boldsymbol\\Sigma = \\boldsymbol\\Sigma^T\\).\n\n\nForce method\nChoosing the test function to be an equilibrated stress field — let’s define it as \\(\\boldsymbol\\Sigma := \\widetilde{\\boldsymbol\\sigma}\\) to recall this condition — i.e. a stress field that satisfies equilibrium conditions\n\\[\\begin{cases}\n  \\boldsymbol\\nabla \\cdot \\widetilde{\\boldsymbol\\sigma} + \\widetilde{\\mathbf{f}} = \\mathbf{0}  && \\text{in $V$} \\\\\n  \\hat{\\mathbf{n}} \\cdot \\widetilde{\\boldsymbol\\sigma} = \\widetilde{\\mathbf{t}}_n   && \\text{on $S_N$} \\\\\n\\end{cases}\\]\n\nunder some external loads \\(\\widetilde{\\mathbf{f}}\\) in \\(V\\) and \\(\\widetilde{\\mathbf{t}}_n\\) on \\(S_N\\). The weak problem thus becomes\n\\[0 = \\int_{V} \\widetilde{\\boldsymbol\\sigma} : \\boldsymbol\\varepsilon - \\int_{V} \\widetilde{\\mathbf{f}} \\cdot \\mathbf{s} - \\int_{S_N} \\widetilde{\\mathbf{t}}_n \\cdot \\mathbf{s} - \\int_{S_D} \\hat{\\mathbf{n}} \\cdot \\widetilde{\\boldsymbol\\sigma} \\cdot \\overline{\\mathbf{s}} - \\int_{S_R} \\dots  \\]\n```bdmtetbxcehf Example: evaluation of hyperstatics :class: tip\nOne of the most common example of applications of force method is the evaluation of hyperstatic actions in over-determined structures.\n```\n\n\nPCVW\nChoosing the test function to be the variation equilibrated stress field — let’s define it as \\(\\boldsymbol\\Sigma := \\delta \\widetilde{\\boldsymbol\\sigma}\\) to recall this condition — i.e. a stress field that satisfies equilibrium conditions\n\\[\\begin{cases}\n  \\boldsymbol\\nabla \\cdot \\delta \\widetilde{\\boldsymbol\\sigma} = \\mathbf{0}  && \\text{in $V$} \\\\\n  \\hat{\\mathbf{n}} \\cdot \\delta \\widetilde{\\boldsymbol\\sigma} = \\mathbf{0}  && \\text{on $S_N$} \\\\\n\\end{cases}\\]\n\nas the variation of given external loads \\(\\widetilde{\\mathbf{f}}\\) in \\(V\\) and \\(\\widetilde{\\mathbf{t}}_n\\) on \\(S_N\\) is identically zero. The weak problem thus becomes\n\\[0 = \\int_{V} \\delta \\widetilde{\\boldsymbol\\sigma} : \\boldsymbol\\varepsilon - \\int_{S_D} \\hat{\\mathbf{n}} \\cdot \\delta \\widetilde{\\boldsymbol\\sigma} \\cdot \\overline{\\mathbf{s}} - \\int_{S_R} \\dots  \\]"
  },
  {
    "objectID": "posts/modes-in-structures/index.html",
    "href": "posts/modes-in-structures/index.html",
    "title": "Natural modes in structures",
    "section": "",
    "text": "This post tries to answer a narrow question I’ve found on Physics SE, mainly about some doubts the OP1 had about standing waves — or natural or proper modes of vibration —, their definition and the role of boundary conditions in the differential problem, and response to external forcing arising from the YouTube video, Standing Waves Parti I: Demonstration, by James Dann, Ph.D."
  },
  {
    "objectID": "posts/modes-in-structures/index.html#natural-modes",
    "href": "posts/modes-in-structures/index.html#natural-modes",
    "title": "Natural modes in structures",
    "section": "Natural modes",
    "text": "Natural modes\nMany structural problems are governed by a differential problem, whose discret(ized) counterpart is a second order dynamical system,\n\\[\\mathbf{M} \\ddot{\\mathbf{u}} + \\mathbf{C} \\dot{\\mathbf{u}} + \\mathbf{K} \\mathbf{u} = \\mathbf{f} \\ ,\\]\nsupplied with the proper conditions on the state \\(\\mathbf{u}(t)\\), like initial values of the function and its first derivative for Cauchy problems (or initial value problems),\n\n\nRemarks\n\n\nThis is a linear problem, and its solution can be written as a linear combination of a set of solutions\nProper modes: a basis for the non-trivial solution of the homogenous problem, i.e. the response of the system to a free system with no external forcing, to a non-zero initial condition\nMass matrix \\(\\mathbf{M}\\) and stiffness matrix \\(\\mathbf{K}\\) are symmetric, if dynamical equations are derived with a Lagrangian approach. Here a proof for rigid-body mechanical systems.\nIf no rigid degree of freedom exists, stiffness matrix is definite positive. If \\(n_r\\) independent degrees of freedom exists, stiffness matrix is semi-definite positive with a kernel of dimension \\(n_r\\) (or it’s \\(n_r\\) times singular).\nIf there’s no degree of freedom associated with zero-inertia, mass matrix is definite positive. Independent d.o.f.s with zero-inertia are usually associated with algebraic constraints: if corresponding d.o.f.s are not expressed as a function of the other d.o.f.s, mass matrix is semi-definite positive (with kernel of dimension \\(n_c\\), whose elements are the mass-less d.o.f.s; or it’s \\(n_c\\) times singular), and the governing equations can be written as a system of DAEs (dynamical-algebraic equations).\nThe modes of an undamped system, \\(\\mathbf{C} = \\mathbf{0}\\), simultaneously diagonalize mass and stiffness matrices. As a consequence of matrix symmetry, it’s easy to prove that modes are mutually orthogonal through mass and stiffness matrices\n\\[\\begin{aligned}\n   \\mathbf{u}_i^T \\mathbf{M} \\mathbf{u}_j & = m_i \\delta_{ij} & \\text{(no sum)} \\\\\n   \\mathbf{u}_i^T \\mathbf{K} \\mathbf{u}_j & = k_i \\delta_{ij} & \\text{(no sum)} \\\\\n\\end{aligned}\\]\nMechanical systems with no dampers usually have small damping. This condition is treated in detail here. In the small-damping regime, damping matrix \\(\\mathbf{C}\\) can be treated as a small perturbation of the undamped system, and two assumptions emerge as reasonable assumptions:\n\n\\(\\mathbf{C}\\) is semi-definite positive\nmodal basis \\(\\{ \\hat{\\mathbf{u}}_i \\}\\) makes the damping matrix \\(\\mathbf{C}\\) diagonal\n\\[\\hat{\\mathbf{u}}^T_i \\mathbf{C} \\hat{\\mathbf{u}}_j = c_i \\delta_{ij} \\ ,\\]\nas well.\n\nIf many eigenvectors exist with the same eigenvalue, it’s possible to define an orthogonal basis of that subspace\n…"
  },
  {
    "objectID": "posts/modes-in-structures/index.html#string",
    "href": "posts/modes-in-structures/index.html#string",
    "title": "Natural modes in structures",
    "section": "String",
    "text": "String\n\nGoverning equations\nThe transverse displacement \\(u(x,t)\\) of a string with axial (tension) pre-load \\(N_0\\) and linear mass density \\(m\\) is governed by the partial differential equation\n\\[- m \\ddot{u} + N_0 u'' = f\\]\nsupplied with proper boundary and initial conditions. Here \\(f(x,t)\\) is the transverse force per unit-length acting on the string.\n\n\nNatural modes\n\n\nResponse to motion of an extreme point (as external forcing)\nExploiting the linearity of the problem, the solution can be written as the sum of a forced and an homogeneous part,\n\\[u(x,t) = u_0(x,t) + u_p(x,t) \\ .\\]\n…some words about slow and fast contributions in structural mechanics, direct truncation and mode acceleration,…\nHere \\(f = 0\\),\n\\[\\begin{cases}\n  - m \\ddot{u} + N_0 u'' = 0   & , \\quad \\text{$(x,t) \\in [0,b] \\times [0, t_{max}]$} \\\\\n  u(0,t) = 0                 & , \\quad \\text{$t \\in [0,t_{max}]$} \\\\\n  u(b,t) = u_B(t) \\\\\n  u(x,0) = u_0(x)            & , \\quad \\text{$x \\in [0,b]$} \\\\\n  \\dot{u}(x,0) = v_0(x)\n\\end{cases}\\]\n\nFast part\nFast part of the solution takes into account non-homogeneous boundary conditions and other external forces. It can be defined through its governing equation\n\\[\\begin{cases}\n  N_0 u''_p = 0           & , \\quad \\text{$(x,t) \\in [0,b] \\times [0, t_{max}]$} \\\\\n  u_p(0,t)  = 0           & , \\quad \\text{$t \\in [0,t_{max}]$} \\\\\n  u_p(b,t)  = u_B(t) \\\\\n\\end{cases}\\]\nwhose solution reads\n\\[u_p(x,t) = u_B(t) \\frac{x}{b} \\ .\\]\n\n\nSlow part\nSlow part taks into account the remaining part of the problem\n\\[\\begin{cases}\n  - m \\ddot{u}_0 + N_0 u''_0 = m \\ddot{u}_p - N_0 \\underbrace{u''_p}_{=0}           & , \\quad \\text{$(x,t) \\in [0,b] \\times [0, t_{max}]$} \\\\\n  u_0(0,t)  = 0                          & , \\quad \\text{$t \\in [0,t_{max}]$} \\\\\n  u_0(b,t)  = 0                                        \\\\\n  u_0(x,0)  = u(x,0) - u_p(x,0)          & , \\quad \\text{$x \\in [0,b]$}       \\\\\n  \\dot{u}_0(x,0) = \\dot{u}(x,0) - \\dot{u}_p(x,0)\n\\end{cases}\\]\nThe solution of this problem can be written as a linear combination\n\\[u_0(x,t) = \\sum_n g_n(t) \\, f_n(x) \\ ,\\]\nof the proper modes,\n\\[f_n(x) = \\sin \\left( k_n x \\right) \\ ,\\]\nwith \\(k_n = \\frac{n \\pi}{b}\\), whose time-dependent amplitudes read\n\\[g_n(t) = a_n \\cos \\left( \\omega_n t \\right) + b_n \\sin \\left( \\omega_n t \\right) \\ ,\\]\nwith \\(\\omega_n = c k_n = \\sqrt{\\frac{N_0}{m}} \\frac{n \\pi}{b}\\), and coefficients \\(a_n\\), \\(b_n\\) evaluated to match the initial conditions.\n\n\nSolution\n\nExploiting orthogonality of harmonic functions,\n\\[\\begin{aligned}\n      \\int_{0}^{b} \\sin \\left(\\frac{n \\pi x}{b}\\right) \\sin \\left(\\frac{m \\pi x}{b} \\right) \\, dx & = \\frac{b}{2} \\delta_{nm} \\\\\n      \\int_{0}^{b} \\cos \\left(\\frac{n \\pi x}{b}\\right) \\cos \\left(\\frac{m \\pi x}{b} \\right) \\, dx & = \\frac{b}{2} \\delta_{nm} \\\\\n      \\int_{0}^{b} \\sin \\left(\\frac{n \\pi x}{b}\\right) \\cos \\left(\\frac{m \\pi x}{b} \\right) \\, dx & = 0 \\\\\n    \\end{aligned}\\]\nand projection of the solution onto these functions,\n\\[\\begin{aligned}\n      0 & = \\int_{x=0}^{b} \\sin\\left( \\dfrac{m \\pi x}{b} \\right) \\left\\{ - m \\ddot{u}_0 + N_0 u''_0 - m \\ddot{u}_p \\right\\} dx = \\\\\n        & = \\int_{x=0}^{b} \\sin\\left( \\dfrac{m \\pi x}{b} \\right) \\sum_n \\left\\{ - m \\ddot{g}_n(t) - k^2_n N_0 g_n(t) \\right\\} \\sin \\left( \\dfrac{n \\pi x}{b} \\right) \\, dx - \\int_{x=0}^b \\sin\\left( \\dfrac{m \\pi x}{b} \\right) m \\frac{x}{b} dx \\, \\ddot{u}_B(t)\n    \\end{aligned}\\]\nthe PDEs can be recast as a (infinite dimension) linear system\n\\[m \\dfrac{b}{2} \\ddot{g}_n(t) + k^2_n N_0 \\dfrac{b}{2} g_n(t) = (-1)^{n} m \\dfrac{b}{\\pi n} \\ddot{u}_B(t) \\ , \\]\nor, dividing by the mass \\(m\\) times \\(\\frac{b}{2}\\) and recalling that \\(k_n = \\frac{n \\pi}{b}\\), \\(c := \\sqrt{\\frac{N_0}{m}}\\) and \\(\\omega_n := c k_n\\),\n\\[\\ddot{g}_n(t) + \\omega_n^2 g_n(t) = (-1)^{n} \\dfrac{2}{\\pi n} \\ddot{u}_P(t) \\ ,\\]\nbeing\n\\[\\begin{aligned}\n    \\int_{x=0}^b \\dfrac{x}{b} \\sin \\left( \\dfrac{m \\pi x}{b} \\right) dx\n      & = \\left.\\left[ - \\dfrac{x}{b} \\dfrac{b}{\\pi m} \\cos\\left( \\dfrac{m \\pi x}{b} \\right) \\right]\\right|_{x=0}^{b} + \\int_{x=0}^{b} \\dfrac{1}{\\pi m} \\cos \\left( \\dfrac{m \\pi x}{b} \\right) \\, dx = \\\\\n      & = - \\dfrac{b}{\\pi m} \\underbrace{\\cos\\left( m \\pi \\right)}_{(-1)^m} + \\underbrace{\\dfrac{b}{(\\pi m)^2} \\left.\\sin\\left( \\dfrac{m \\pi x}{b} \\right)\\right|_{x=0}^{b}}_{=0} = \\\\\n      & = -(-1)^{m} \\dfrac{b}{\\pi m} \\ .\n    \\end{aligned}\\]\nThe solution of the equation for \\(g_n\\) can be written as the sum of the solution of the homogeneous equation and an independent particular solution \\(g_{n,P}\\)\n\\[g_n(t) = a_n \\cos \\left( \\omega_n t \\right) + b_n \\sin \\left( \\omega_n t \\right) + g_{n,P}(t) \\ ,\\]\n\n\n\nSligthly damped system\nMechanical systems without any damper element usually have small damping, that can be well represented as a modal damping. Under this assumption, the modal equations become\n\\[\\ddot{g}_n(t) + 2 \\xi_n \\omega_n \\dot{g}_n(t) + \\omega_n^2 g_n(t) = (-1)^{n} \\dfrac{2}{\\pi n} \\ddot{u}_B(t) \\ ,\\]\nwith \\(\\xi_n \\ll 1\\). The eigenvalues of the equation comes from the solution of the algebraic equation\n\\[s^2 + 2 \\xi_n \\omega_n s + \\omega^2_n = 0 \\qquad \\rightarrow \\qquad s_{1,2} = - \\xi_{n} \\omega_n \\mp \\sqrt{\\xi_n^2 \\omega_n^2 - \\omega^2_n} = \\omega_n \\left[ -\\xi_n \\mp i \\sqrt{ 1 - \\xi_n^2 } \\right] \\ ,\\]\nand the solution of the homogeneous equation reads\n\\[\\begin{aligned}\n  g_{n,0}(t)\n  & = c_n e^{\\left(- \\xi_n \\mp i \\sqrt{1-\\xi^2_n} \\right) \\omega_n t} + \\text{ c.c.} = \\\\\n  & = a_n e^{-\\xi_n \\omega_n t} \\cos\\left( \\sqrt{1 - \\xi^2_n} \\, \\omega_n t \\right) + b_n e^{-\\xi_n \\omega_n t} \\sin\\left( \\sqrt{1 - \\xi^2_n} \\, \\omega_n t \\right)\n\\end{aligned}\\]\nIf the damping is non-zero, \\(\\xi_n &gt; 0\\), and the homogeneous part of the solution \\(g_{n,0}(t)\\) goes to zero for sufficient long time,\n\\[\\lim_{t \\rightarrow + \\infty} g_{n,0}(t) \\rightarrow 0 \\ ,\\]\nand thus the free response of the system — and the effect of the initial condition — becomes negligible and only the forced response is relevant.\n\n\nHarmonic forcing\nWith \\(u_B(t) = U \\sin \\left( \\Omega t \\right)\\), the particular solution has the expression\n\\[g_{n,P}(t) = A_n \\cos\\left( \\Omega t \\right) + B_n \\sin\\left( \\Omega t \\right) \\ , \\]\nwhose coefficients \\(A_n\\), \\(B_n\\) can be evaluated matching harmonic terms\n\\[\n\\begin{bmatrix}\n-\\Omega^2+\\omega_n^2 & 2 \\xi_n \\omega_n \\Omega \\\\\n-2 \\xi_n \\omega_n \\Omega & -\\Omega^2+\\omega_n^2\n\\end{bmatrix}\n\\begin{bmatrix} A_n \\\\ B_n \\end{bmatrix} =\n\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} (-1)^{n+1} \\dfrac{2}{\\pi n} U \\Omega^2\n\\]\n\\[\\begin{aligned}\n\\begin{bmatrix} A_n \\\\ B_n \\end{bmatrix} & =\n\\dfrac{1}{\\left( - \\Omega^2 + \\omega^2_n \\right)^2 + \\left( 2 \\xi_n \\omega_n \\Omega \\right)^2}\n\\begin{bmatrix}\n-\\Omega^2+\\omega_n^2 & -2 \\xi_n \\omega_n \\Omega \\\\\n2 \\xi_n \\omega_n \\Omega & -\\Omega^2+\\omega_n^2\n\\end{bmatrix}\n\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} (-1)^{n+1} \\dfrac{2}{\\pi n} U \\Omega^2 = \\\\\n& =  (-1)^{n+1} \\dfrac{2}{\\pi n} \\dfrac{\\Omega^2}{\\left(-\\Omega^2 + \\omega^2_n \\right)^2 + \\left( 2 \\xi_n \\omega_n \\Omega \\right)^2}\n\\begin{bmatrix} -2 \\xi_n \\omega_n \\Omega \\\\ -\\Omega^2 + \\omega^2_n \\end{bmatrix} U \\ .\n\\end{aligned}\\]\nExploiting properties of harmonic functions, the particular solution can be recast as\n\\[\\begin{aligned}\n  \\dfrac{g_{n,P}(t)}{U}\n  & = A_n \\cos(\\Omega t ) + B_n \\sin(\\Omega t ) = \\\\\n  & = C_n \\sin(\\Omega t + \\varphi_n ) = \\\\\n  & = C_n \\left( \\dfrac{A_n}{C_n} \\cos(\\Omega t) + \\dfrac{B_n}{C_n} \\sin(\\Omega t) \\right) = \\\\\n  & = C_n \\left( \\sin \\varphi_n \\cos(\\Omega t) + \\cos \\varphi_n \\sin(\\Omega t) \\right) \\ ,\n\\end{aligned}\\]\nwith gain \\(C_n = \\sqrt{A^2_n + B^2_n}\\), i.e.\n\\[\\begin{aligned}\n  C_n\n  & = \\dfrac{2}{\\pi n} \\dfrac{\\Omega^2}{\\left(-\\Omega^2 + \\omega^2_n \\right)^2 + \\left( 2 \\xi_n \\omega_n \\Omega \\right)^2}\\sqrt{\\left(-\\Omega^2 + \\omega^2_n \\right)^2 + \\left( 2 \\xi_n \\omega_n \\Omega \\right)^2} = \\\\\n  & = \\dfrac{2}{\\pi n} \\dfrac{\\Omega^2}{\\sqrt{\\left(-\\Omega^2 + \\omega^2_n \\right)^2 + \\left( 2 \\xi_n \\omega_n \\Omega \\right)^2}} = \\\\\n  & = \\dfrac{2}{\\pi n} \\dfrac{\\left(\\frac{\\Omega}{\\omega_n}\\right)^2}{\\sqrt{\\left(1 - \\left(\\frac{\\Omega}{\\omega_n}\\right)^2 \\right)^2 + \\left( 2 \\xi_n \\frac{\\Omega}{\\omega_n} \\right)^2}} \\ ,\n\\end{aligned}\\]\nand phase delay \\(\\varphi_n\\) s.t.\n\\[ \\varphi_n = \\text{atan2}\\left( a \\sin \\varphi_n, a \\cos \\varphi_n \\right) = \\text{atan2}\\left( A_n, B_n \\right) = \\left( (-1)^{n} \\cdot 2 \\xi_n \\omega_n \\Omega , (-1)^{n} ( \\Omega^2 - \\omega_n^2 ) \\right) \\ ,\\]\nhaving exploited the definition of an \\(\\text{atan2}(\\cdot)\\) function, whose co-domain width is \\(2\\pi\\).\n\nGain as a function of frequency \\(\\Omega\\) of the forcing.\n\\[f(x) = \\dfrac{x^2}{\\left( ( 1 - x^2)^2 + 4 \\xi^2 x^2  \\right)^{\\frac{1}{2}}}\\]\n\\[\\begin{aligned}\n  f'(x)\n  & = \\dfrac{2 x ( ( 1 - x^2)^2 + 4 \\xi^2 x^2 )^{\\frac{1}{2}} - x^2 \\frac{1}{2} ( ( 1 - x^2)^2 + 4 \\xi^2 x^2  )^{-\\frac{1}{2}} \\left( - 2 ( 1 - x^2 ) \\cdot 2 x + 8 \\xi^2 x \\right) }{(1-x^2)^2 + 4 \\xi^2 x^2} = \\\\\n  & = \\dfrac{ 2x - 4 x^3 + 2 x^5 + 8 \\xi^2 x^3 - \\left( - 2 x^3 + 2 x^5 + 4 \\xi^2 x^3 \\right) }{\\left\\{(1-x^2)^2 + 4 \\xi^2 x^2\\right\\}^{\\frac{3}{2}}} = \\\\\n  & = \\dfrac{ 2x - 2 x^3 + 4 \\xi^2 x^3}{\\left\\{(1-x^2)^2 + 4 \\xi^2 x^2\\right\\}^{\\frac{3}{2}}} = \\\\\n  & = \\dfrac{ 2 x ( 1 - ( 1 - 2 \\xi^2 ) x^2)}{\\left\\{(1-x^2)^2 + 4 \\xi^2 x^2\\right\\}^{\\frac{3}{2}}} = \\\\\n\\end{aligned}\\]\na maximum exists for \\(\\bar{x} = \\frac{1}{\\sqrt{1- 2 \\xi^2}}\\), if \\(\\xi &lt; \\frac{1}{\\sqrt{2}}\\),\n\\[\\begin{aligned}\n  f(\\bar{x})\n  & = \\dfrac{\\frac{1}{1-2\\xi^2}}{\\left( \\left( 1 - \\frac{1}{1-2\\xi^2} \\right)^2  + 4 \\xi^2 \\frac{1}{1 - 2 \\xi^2}\\right)^{\\frac{1}{2}}} = \\\\\n  & = \\dfrac{1}{\\left( 4 \\xi^4 + 4 \\xi^2 ( 1- 2 \\xi^2) \\right)^{\\frac{1}{2}}} = \\\\\n  & = \\frac{1}{2 \\xi (1-\\xi^2)^{\\frac{1}{2}}}\n\\end{aligned}\\]\n\n#&gt; Some libraries\nimport numpy as np\nfrom scipy import signal\nimport matplotlib.pyplot as plt\n\n#&gt; Bode diagram of the natural modes\n\n#&gt; Parameters of the system (non-dimensional)\nm, N0, b = 1., 1., np.pi\nc = np.sqrt(N0/m)\nxi = .02\n\nn_modes = 30\ni_modes = np.arange(1, n_modes+1)\nomegas = 10.**np.linspace(-.5, 1.5, 1000)\n\nfig, ax = plt.subplots(2,1, figsize=(5, 5))\n\nfor i_mode in i_modes:\n    #&gt; Mode parameters\n    k_n = i_mode * np.pi / b\n    omega_n = k_n * c\n    xi_n = xi\n\n    #&gt; Continuous-time TF (no dt is given as a third argument in signal.TransferFunction)\n    # defined with numerator and denominator\n    num = np.array([1, 0, 0]) * (-1)**(i_mode+1) * 2. / ( np.pi * i_mode )\n    den = np.array([1, 2*xi_n*omega_n, omega_n**2])\n    sys = signal.TransferFunction(num, den)\n\n    #&gt; Evaluation of magnitude and phase of the TF of the LTI system sys\n    # mag is in dB i.e. |G|_{dB} = 20 log_10{|G|}se\n    w, mag, phase = signal.bode(sys, omegas)\n\n    #&gt; Plot\n    ax[0].semilogx(omegas, mag  , lw=.7)\n    ax[1].semilogx(omegas, phase, lw=.7)\n\nG_ticks = 20 * np.arange(-4,3)\nax[0].set_yticks(G_ticks)\nax[0].set_xlim(omegas[0], omegas[-1]);  ax[0].grid()\nax[0].set_ylim(G_ticks[0], G_ticks[-1])\nax[1].set_xlim(omegas[0], omegas[-1]);  ax[1].grid()\nax[0].set_ylabel('$|G|_{dB}$')\nax[1].set_xlabel('$\\Omega$')\nax[1].set_ylabel('$\\phi$')\n\nText(0, 0.5, '$\\\\phi$')\n\n\n\n\n\n\n\n\n\n\n\nFull solution\nFull solution of the problem with the prescribed motion \\(u_B(t) = U \\sin(\\Omega t)\\) reads\n\\[\\begin{aligned}\n  u(x,t) & = \\left\\{ \\frac{x}{b} \\sin(\\Omega t) + \\sum_n \\sin \\left( k_n x \\right) g_{n,p}(t) \\right\\} U_B + \\sum_{n} C_{n,0} \\sin( k_n x ) e^{-\\xi_n \\omega_n t} \\cos \\left( \\sqrt{1 - \\xi^2_n} \\, \\omega_n t - \\varphi_{n,0} \\right) \\\\\n  & = \\left\\{ \\frac{x}{b} \\sin(\\Omega t) + \\sum_n \\sin \\left( k_n x \\right) C_n(\\Omega) \\sin(\\Omega t + \\varphi_n(\\Omega) ) \\right\\} U_B + \\sum_{n} C_{n,0} \\sin( k_n x ) e^{-\\xi_n \\omega_n t} \\cos \\left( \\sqrt{1 - \\xi^2_n} \\, \\omega_n t + \\varphi_{n,0} \\right)\n\\end{aligned}\\]\ns.t. its time derivative \\(\\partial_t u(x,t)\\) is\n\\[\\begin{aligned}\n  \\dot{u}(x,t)\n  & = \\left\\{ \\frac{x}{b} \\cos(\\Omega t) + \\sum_n \\sin \\left( k_n x \\right) C_n(\\Omega) \\cos(\\Omega t + \\phi_n(\\Omega) ) \\right\\} \\Omega U_B + \\sum_{n} C_{n,0} \\sin( k_n x ) e^{-\\xi_n \\omega_n t} \\left[ - \\xi_n \\omega_n \\cos \\left( \\sqrt{1 - \\xi^2_n} \\, \\omega_n t + \\varphi_{n,0} \\right) - \\sqrt{1-\\xi_n^2} \\omega_n \\sin\\left( \\sqrt{1 - \\xi^2_n} \\, \\omega_n t + \\varphi_{n,0} \\right) \\right]\n\\end{aligned}\\]\nBoth forced and free response can be re-written as the sum of a \\(\\sin\\) and \\(\\cos\\) contribution per each wave number. The coefficients \\(A_n\\), \\(B_n\\) of the forced response have already been evaluated above. The coefficients of the free response \\(A_{0,n}\\), \\(B_{0,n}\\) need to be evaluated with the initial conditions.\n\\[f(t) = e^{-\\xi \\omega t} \\left[ A_0 \\cos(\\widetilde{\\omega} t) + B_0 \\sin(\\widetilde{\\omega} t) \\right]\\]\n\\[\\dot{f}(t) = e^{-\\xi \\omega t} \\left[ A_0 \\left( -\\xi \\omega \\cos(\\widetilde{\\omega} t) - \\widetilde{\\omega} \\sin(\\widetilde{\\omega} t) \\right) + B_0 \\left(-\\xi \\omega \\sin(\\widetilde{\\omega} t) + \\widetilde{\\omega} \\cos(\\widetilde{\\omega} t) \\right) \\right]\\]\n\n\nSolving for initial conditions\nProjection to find a linear system for the coefficients \\(A_{n,0}\\), \\(B_{n,0}\\)…\n\\[u_0(x) = u(x,0) = \\sum_{n} \\sin(k_n x) A_n U_B + \\sum_{n} A_{n,0} \\sin(k_n x)\\]\n\\[v_0(x) = \\dot{u}(x,0) = \\dfrac{x}{b}\\Omega U_B + \\sum_{n} B_n \\Omega U_B \\sin(k_n x) + \\sum_{n} \\left\\{ - A_{n,0} \\xi_n \\omega_n + B_{n,0} \\omega_n \\sqrt{1 - \\xi_n^2} \\right\\} \\sin(k_n x)\\]\nThis is a system of two equations, with infinite unknowns \\(A_{n,0}\\), \\(B_{n,0}\\). While this sounds like a very under-determined system, this is not the case since the two equations depends on the continuous spatial coordinate \\(x\\) and thus they’re 2 infinite-dimensional equations: each equation is not just an equality, but it’s an equality that needs to hold for every possible \\(x \\in [0,b]\\), and thus each equation prescribes infinite constraints.\nNow, infinite constraints and infinite unknowns…the problem looks trickier and trickier. But it’s quite easy to solve through projection on the functions \\(\\sin( k_p x )\\) exploiting the orthogonality of these harmonic functions on the interval \\([0,b]\\). This process should recall to the reader the Fourier series expansion of periodic functions. The equations become an infinite number of decoupled pairs of equations,\n\\[\\int_{x=0}^{b} \\sin(k_p x) u_0(x) dx = \\dfrac{b}{2} \\left( A_p U_B + A_{p,0} \\right)\\]\n\\[\\int_{x=0}^{b} \\sin(k_p x) \\left( v_0(x) - \\dfrac{x}{b} \\Omega U_B \\right) \\, dx = \\dfrac{b}{2} \\left( B_p \\Omega U_B + \\omega_p \\left( - \\xi_p A_{p,0} + \\sqrt{1 - \\xi^2_p} B_{p,0} \\right) \\right)\\]\nwhose results are easily evaluated as\n\\[\\begin{aligned}\n  A_{p,0} & = - A_p U_B + \\dfrac{2}{b} \\int_{x=0}^{b} \\sin(k_p x) u_0(x) \\, dx \\\\\n  B_{p,0} & = \\dots\n\\end{aligned}\\]"
  },
  {
    "objectID": "posts/modes-in-structures/index.html#footnotes",
    "href": "posts/modes-in-structures/index.html#footnotes",
    "title": "Natural modes in structures",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nSlang proper of Stack Exchange and other forums, OP means Original Poster.↩︎"
  }
]